var a,b;a=this,b=function(){"use strict";function i(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a="data-result",l={resultsList:"autoComplete_results_list",result:"autoComplete_result",highlight:"autoComplete_highlighted"},u=function(t){return"string"==typeof t?document.querySelector(t):t()},c=function(t){return t.innerHTML=""},h=u,r=function(t){var e=document.createElement("ul");return t.container&&(l.resultsList=t.container(e)||l.resultsList),t.destination.insertAdjacentElement(t.position,e),e},f=function(t){return"<span class=".concat(l.highlight,">").concat(t,"</span>")},o=function(i,r,o,u){r.forEach(function(t,e){var s=document.createElement("li"),n=r[e].source[o]||r[e].source;s.setAttribute(a,n),s.setAttribute("class",l.result),s.setAttribute("tabindex","1"),s.innerHTML=u?u(t,s):t.match||t,i.appendChild(s)})},d=function(t,s){var n=u(t),i=s.firstChild;document.onkeydown=function(t){var e=document.activeElement;switch(t.keyCode){case 38:e!==i&&e!==n?e.previousSibling.focus():e===i&&n.focus();break;case 40:e===n&&0<s.childNodes.length?i.focus():e!==s.lastChild&&e.nextSibling.focus()}}},p=c,v=function(s,n,i,r,o){n.querySelectorAll(".".concat(l.result)).forEach(function(e){["mousedown","keydown"].forEach(function(t){e.addEventListener(t,function(e){"mousedown"!==t&&13!==e.keyCode||(i({event:e,query:u(s).value,results:r.map(function(t){return t.source}),selection:r.find(function(t){return(t.source[o]||t.source)===e.target.closest(".".concat(l.result)).getAttribute(a)}).source}),c(n))})})})};return function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.selector=t.selector||"#autoComplete",this.data={src:function(){return"function"==typeof t.data.src?t.data.src():t.data.src},key:t.data.key},this.searchEngine="loose"===t.searchEngine?"loose":"strict",this.threshold=t.threshold||0,this.resultsList=r({container:!(!t.resultsList||!t.resultsList.container)&&t.resultsList.container,destination:t.resultsList&&t.resultsList.destination?t.resultsList.destination:h(this.selector),position:t.resultsList&&t.resultsList.position?t.resultsList.position:"afterend"}),this.placeHolder=t.placeHolder,this.maxResults=t.maxResults||5,this.resultItem=t.resultItem,this.highlight=t.highlight||!1,this.onSelection=t.onSelection,this.init()}var t,s,n;return t=e,(s=[{key:"search",value:function(t,e){var s=this.highlight,n=e.toLowerCase();if("loose"===this.searchEngine){t=t.replace(/ /g,"");for(var i=[],r=0,o=0;o<n.length;o++){var u=n[o];r<t.length&&u===t[r]&&(u=s?f(u):u,r++),i.push(u)}return r===t.length&&i.join("")}if(n.includes(t)){if(s){var a=h(this.selector).value.toLowerCase();return n.replace(a,f(a))}return n}}},{key:"listMatchedResults",value:function(t){var s=this,n=[],i=h(this.selector).value.toLowerCase();t.filter(function(t){var e=s.search(i,t[s.data.key]||t);e&&n.push({match:e,source:t})});var e=n.slice(0,this.maxResults);return o(this.resultsList,e,this.data.key,this.resultItem),d(this.selector,this.resultsList),e}},{key:"ignite",value:function(s){var n=this,i=this.selector,r=h(i),t=this.placeHolder,o=this.onSelection;t&&r.setAttribute("placeholder",t),r.onkeyup=function(){var t=n.resultsList;p(t);if(r.value.length>n.threshold&&r.value.replace(/ /g,"").length){var e=n.listMatchedResults(s);o&&v(i,t,o,e,n.data.key)}}}},{key:"init",value:function(){var e=this,t=this.data.src();t instanceof Promise?t.then(function(t){return e.ignite(t)}):this.ignite(t)}}])&&i(t.prototype,s),n&&i(t,n),e}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):a.autoComplete=b();
